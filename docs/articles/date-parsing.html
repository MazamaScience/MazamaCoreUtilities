<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Date Parsing • MazamaCoreUtils</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Date Parsing">
<meta property="og:description" content="MazamaCoreUtils">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MazamaCoreUtils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MazamaScience/MazamaCoreUtils/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Date Parsing</h1>
                        <h4 data-toc-skip class="author">Jonathan
Callahan</h4>
            
            <h4 data-toc-skip class="date">2019-08-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MazamaScience/MazamaCoreUtils/blob/HEAD/vignettes/date-parsing.Rmd" class="external-link"><code>vignettes/date-parsing.Rmd</code></a></small>
      <div class="hidden name"><code>date-parsing.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="environmental-time-series-data">Environmental Time Series Data<a class="anchor" aria-label="anchor" href="#environmental-time-series-data"></a>
</h2>
<p>Dates, times and timezones can be frustrating, especially when
working with environmental time series such as those collected by air
and water quality sensors.</p>
<p>Environmental time series data often have a strong diurnal signal and
are typically plotted with a time axis displaying local time. However,
when data are aggregated into larger collections, it is typical to store
data with a universal time axis – UTC.</p>
<p>Problems can arise when parsing and formatting dates and times
because R defaults to the system timezone available with
<code><a href="https://rdrr.io/r/base/timezones.html" class="external-link">Sys.timezone()</a></code>. Imagine an agency scientist based in
Washington, DC, using their laptop to display recent air quality data
from Los Angeles while at a conference in Tasmania. The data center
processing the data might be in Boulder but the data processing machine
might be set to use UTC. Potential timezones (available with
<code><a href="https://rdrr.io/r/base/timezones.html" class="external-link">OlsonNames()</a></code>) relevant to this scenario include:</p>
<ul>
<li><code>America/New_York</code></li>
<li><code>America/Los_Angeles</code></li>
<li><code>Australia/Tasmania</code></li>
<li><code>America/Denver</code></li>
<li><code>UTC</code></li>
</ul>
<p>Which timezone should be used to convert a request for data from
“2019-08-08”” to “2018-08-15”” into <code>POSIXct</code> datetimes?</p>
<p>To enforce specification of timezones and to help with the common
user interface need to specify a range of dates or times, the
<strong>MazamaCoreUtils</strong> package provides the following
functions:</p>
<ul>
<li>
<code><a href="../reference/dateRange.html">dateRange()</a></code> – parses and returns <code>POSIXct</code>
start and end dates representing full days in the specified
timezone</li>
<li>
<code><a href="../reference/timeRange.html">timeRange()</a></code> – parses and returns <code>POSixct</code>
start and end times in the specified timezone</li>
<li>
<code><a href="../reference/parseDatetime.html">parseDatetime()</a></code> – parses and returns a vector of
<code>POSIXct</code> values in the specified timezone</li>
</ul>
<p>The <code><a href="../reference/parseDatetime.html">parseDatetime()</a></code> function is intended as a
timezone-requiring replacement for
<code><a href="https://lubridate.tidyverse.org/reference/parse_date_time.html" class="external-link">lubridate::parse_date_time()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="linting-for-timezones">Linting for timezones<a class="anchor" aria-label="anchor" href="#linting-for-timezones"></a>
</h2>
<p>Enforcing the specification of timezones throughout a body of code is
the most robust way to remove timezone-related errors from your
software. To help with this this type of code review, the package also
includes functions for testing whether specific named arguments are used
with certain function calls:</p>
<ul>
<li>
<code><a href="../reference/lintFunctionArgs.html">lintFunctionArgs_file()</a></code> – check a single file</li>
<li>
<code><a href="../reference/lintFunctionArgs.html">lintFunctionArgs_dir()</a></code> – check an entire directory</li>
</ul>
<p>To use these functions you must define a set of
<code>function:argument</code> rules to be applied such as:</p>
<pre><code><span><span class="va">timezoneLintRules</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"parse_date_time"</span> <span class="op">=</span> <span class="st">"tz"</span>,</span>
<span>  <span class="st">"with_tz"</span> <span class="op">=</span> <span class="st">"tzone"</span>,</span>
<span>  <span class="st">"now"</span> <span class="op">=</span> <span class="st">"tzone"</span>,</span>
<span>  <span class="st">"strftime"</span> <span class="op">=</span> <span class="st">"tz"</span></span>
<span><span class="op">)</span></span></code></pre>
<p>This is interpreted as:</p>
<ul>
<li>Every use of the <code>parse_date_time()</code> function must use
the <code>tz</code> argument explicitly.</li>
<li>Every use of the <code>with_tz()</code> function must use the
<code>tzone</code> argument explicitly</li>
<li>…</li>
</ul>
<p>While these functions could be used to test for explicit use in any
<code>function:argument</code> pair, our concern here is primarily with
specification of timezones. The packages includes a detailed list of
<code>timezoneLintRules</code> to help with this. As an example, here is
the result of linting the <code>dateRange.R</code> function in this
package:</p>
<pre><code>&gt; lintFunctionArgs_file("R/dateRange.R", timezoneLintRules)
# A tibble: 7 x 6
  file        line_number column_number function_name   named_args includes_required
  &lt;chr&gt;             &lt;int&gt;         &lt;int&gt; &lt;chr&gt;           &lt;list&gt;     &lt;lgl&gt;            
1 dateRange.R         125            29 with_tz         &lt;chr [1]&gt;  TRUE             
2 dateRange.R         128            27 with_tz         &lt;chr [1]&gt;  TRUE             
3 dateRange.R         141            18 parse_date_time &lt;chr [2]&gt;  TRUE             
4 dateRange.R         142            18 parse_date_time &lt;chr [2]&gt;  TRUE             
5 dateRange.R         159            18 parse_date_time &lt;chr [2]&gt;  TRUE             
6 dateRange.R         176            18 parse_date_time &lt;chr [2]&gt;  TRUE             
7 dateRange.R         188            18 now             &lt;chr [1]&gt;  TRUE             </code></pre>
<p>The result shows that the <code>dateRange.R</code> source code is
consistent in always explicitly specifying a timezone.</p>
<p>Hopefully, this attention to timezones will help your code avoid
misunderstandings when it comes to date and time requests.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jonathan Callahan.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
